<div class="flex h-screen">
  @if (authService.isLoggedIn) {
    <app-sidebar 
      (collapsedChange)="isSidebarCollapsed = $event"
      [isCollapsed]="isSidebarCollapsed" 
      [conversations]="(conversations$ | async) || []" 
      [selectedConversationId]="selectedConversationId$ | async"
      [isLoading]="(isLoading$ | async) || false"
      (newChatClick)="onNewChatClick()"
      (conversationSelect)="onConversationSelect($event)"
      (conversationDelete)="onConversationDelete($event)"
    ></app-sidebar>
  }

  <div
    class="flex-1 flex flex-col overflow-hidden relative transition-all duration-300"
    [ngClass]="{
      'md:ml-16': isSidebarCollapsed && authService.isLoggedIn,
      'md:ml-52': !isSidebarCollapsed && authService.isLoggedIn
    }"
  >
    <app-navbar 
        [isLoggedIn]="authService.isLoggedIn"
        [conversations]="(conversations$ | async) || []"
        [selectedConversationId]="selectedConversationId$ | async"
        [isLoading]="(isLoading$ | async) || false"
        (newChatClick)="onNewChatClick()"
        (conversationSelect)="onConversationSelect($event)"
        (conversationDelete)="onConversationDelete($event)"
        (toggleMobileSidebar)="onMobileSidebarToggle()" 
        [ngClass]="{'md:hidden': authService.isLoggedIn}"
    ></app-navbar>

    <main class="flex-1 overflow-auto">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>